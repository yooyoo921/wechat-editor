<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¬ä¼—å·æ’ç‰ˆå¤§å¸ˆ - ç»ˆæä¼˜åŒ–ç‰ˆ</title>
    <script src="https://cdn.staticfile.org/vue/3.3.4/vue.global.prod.min.js"></script>
    <script src="https://cdn.staticfile.org/marked/9.1.2/marked.min.js"></script>
    
    <style>
        /* --- å…¨å±€æ ·å¼ --- */
        body { margin: 0; background: #f0f2f5; font-family: "PingFang SC", "Microsoft YaHei", sans-serif; height: 100vh; display: flex; flex-direction: column; overflow: hidden; color: #333; }
        
        /* é¡¶éƒ¨å¯¼èˆª */
        .header { background: white; padding: 12px 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; z-index: 20; }
        .logo { font-size: 20px; font-weight: 800; color: #333; display: flex; align-items: center; gap: 8px; }
        .logo span { color: #07c160; background: #e6f7ef; padding: 2px 8px; border-radius: 4px; font-size: 14px; }
        
        .btn-copy { 
            background: #07c160; color: white; border: none; padding: 8px 25px; border-radius: 6px; 
            font-weight: bold; cursor: pointer; font-size: 15px; box-shadow: 0 4px 10px rgba(7, 193, 96, 0.2); transition: 0.2s; 
        }
        .btn-copy:hover { background: #06ad56; transform: translateY(-1px); }
        .btn-copy:active { transform: translateY(0); }

        /* ä¸»å·¥ä½œåŒº */
        .workspace { flex: 1; display: flex; gap: 20px; padding: 20px; max-width: 1600px; margin: 0 auto; width: 100%; box-sizing: border-box; overflow: hidden; }
        
        /* å·¦ä¾§ï¼šç¼–è¾‘é¢æ¿ */
        .panel-left { flex: 1; background: white; border-radius: 12px; display: flex; flex-direction: column; box-shadow: 0 4px 12px rgba(0,0,0,0.03); min-width: 0; overflow: hidden; border: 1px solid #eef0f2; }
        
        /* 1. å…¨å±€è®¾ç½®æ  (å­—å·/é—´è·) */
        .settings-bar { padding: 12px 20px; background: #fafafa; border-bottom: 1px solid #eee; display: flex; align-items: center; gap: 20px; font-size: 14px; color: #555; }
        .slider-group { display: flex; align-items: center; gap: 8px; }
        input[type=range] { width: 100px; cursor: pointer; accent-color: #07c160; }

        /* 2. é£æ ¼é€‰æ‹©æ  */
        .style-bar { padding: 12px 20px; border-bottom: 1px solid #eee; display: flex; gap: 10px; background: #fff; flex-wrap: wrap; }
        .style-btn { 
            padding: 6px 14px; border: 1px solid #eee; border-radius: 6px; cursor: pointer; 
            font-size: 13px; color: #666; transition: 0.2s; background: white; display: flex; align-items: center; gap: 5px;
        }
        .style-btn:hover { border-color: #07c160; color: #07c160; }
        .style-btn.active { background: #e6f7ef; border-color: #07c160; color: #07c160; font-weight: bold; }
        .color-dot { width: 10px; height: 10px; border-radius: 50%; }

        /* 3. å·¥å…·æ  (æŒ‰é’®+è¡¨æƒ…) */
        .toolbar { padding: 10px 20px; background: #fff; border-bottom: 1px solid #eee; display: flex; flex-direction: column; gap: 10px; }
        .tool-row { display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
        .tool-btn { 
            background: #f4f6f8; border: none; padding: 6px 12px; border-radius: 4px; 
            cursor: pointer; font-size: 13px; font-weight: 600; color: #444; transition: 0.2s;
        }
        .tool-btn:hover { background: #e0e4e8; }
        .emoji-btn { font-size: 18px; cursor: pointer; padding: 2px 5px; transition: 0.2s; border-radius: 4px; }
        .emoji-btn:hover { background: #eee; transform: scale(1.2); }

        /* ç¼–è¾‘æ¡† */
        .editor-area { flex: 1; position: relative; }
        textarea { 
            width: 100%; height: 100%; border: none; padding: 25px; resize: none; outline: none; 
            font-size: 16px; line-height: 1.7; color: #333; font-family: monospace;
        }

        /* å³ä¾§ï¼šæ‰‹æœºé¢„è§ˆ */
        .panel-right { width: 400px; display: flex; justify-content: center; align-items: center; flex-shrink: 0; background: #f0f2f5; }
        .phone-frame { 
            width: 375px; height: 95%; max-height: 800px; background: white; 
            border: 12px solid #2d3436; border-radius: 40px; position: relative; 
            display: flex; flex-direction: column; box-shadow: 0 20px 50px rgba(0,0,0,0.15); overflow: hidden; 
        }
        .notch { position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 140px; height: 24px; background: #2d3436; border-bottom-left-radius: 16px; border-bottom-right-radius: 16px; z-index: 20; }
        .preview-scroll { flex: 1; overflow-y: auto; padding: 30px 20px; background: #fff; transition: all 0.3s; }
        .preview-scroll::-webkit-scrollbar { width: 5px; }
        .preview-scroll::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 1000px) {
            .workspace { flex-direction: column; overflow-y: auto; }
            .panel-right { width: 100%; height: 600px; padding-bottom: 30px; }
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="header">
            <div class="logo">å…¬ä¼—å·æ’ç‰ˆå¤§å¸ˆ <span>ç»ˆæä¼˜åŒ–ç‰ˆ</span></div>
            <button class="btn-copy" @click="copyResult">{{ copyText }}</button>
        </div>

        <div class="workspace">
            <div class="panel-left">
                
                <div class="settings-bar">
                    <div class="slider-group">
                        <span>å­—ä½“å¤§å°: {{ baseFontSize }}px</span>
                        <input type="range" min="14" max="20" step="0.5" v-model="baseFontSize" @input="render">
                    </div>
                    <div class="slider-group">
                        <span>è¡Œé—´è·: {{ lineHeight }}</span>
                        <input type="range" min="1.4" max="2.2" step="0.1" v-model="lineHeight" @input="render">
                    </div>
                </div>

                <div class="style-bar">
                    <div class="style-btn" :class="{ active: currentTheme === 'business' }" @click="setTheme('business')">
                        <div class="color-dot" style="background:#1890ff"></div> å•†åŠ¡è“
                    </div>
                    <div class="style-btn" :class="{ active: currentTheme === 'warm' }" @click="setTheme('warm')">
                        <div class="color-dot" style="background:#f59e0b"></div> ç”Ÿæ´»æš–
                    </div>
                    <div class="style-btn" :class="{ active: currentTheme === 'clean' }" @click="setTheme('clean')">
                        <div class="color-dot" style="background:#059669"></div> ç®€çº¦ç»¿
                    </div>
                    <div class="style-btn" :class="{ active: currentTheme === 'festive' }" @click="setTheme('festive')">
                        <div class="color-dot" style="background:#e11d48"></div> èŠ‚æ—¥çº¢ (æ–°)
                    </div>
                    <div class="style-btn" :class="{ active: currentTheme === 'luxury' }" @click="setTheme('luxury')">
                        <div class="color-dot" style="background:#d4af37"></div> é»‘é‡‘å¥¢ (æ–°)
                    </div>
                </div>

                <div class="toolbar">
                    <div class="tool-row">
                        <button class="tool-btn" @click="insertFormat('## ', '')">H1 å¤§æ ‡é¢˜</button>
                        <button class="tool-btn" @click="insertFormat('### ', '')">H2 å°æ ‡é¢˜</button>
                        <button class="tool-btn" @click="insertFormat('**', '**')">B åŠ ç²—</button>
                        <button class="tool-btn" @click="insertFormat('> ', '')">â€œ å¼•ç”¨æ¡†</button>
                        <button class="tool-btn" style="color:#d9534f" @click="clearInput">ğŸ—‘ æ¸…ç©º</button>
                    </div>
                    <div class="tool-row" style="border-top:1px dashed #eee; padding-top:8px;">
                        <span style="font-size:12px; color:#999;">å¸¸ç”¨è¡¨æƒ…ï¼š</span>
                        <span class="emoji-btn" @click="insertEmoji('ğŸ‰')">ğŸ‰</span>
                        <span class="emoji-btn" @click="insertEmoji('ğŸŒ¹')">ğŸŒ¹</span>
                        <span class="emoji-btn" @click="insertEmoji('ğŸ‘')">ğŸ‘</span>
                        <span class="emoji-btn" @click="insertEmoji('ğŸ’ª')">ğŸ’ª</span>
                        <span class="emoji-btn" @click="insertEmoji('ğŸ¤')">ğŸ¤</span>
                        <span class="emoji-btn" @click="insertEmoji('âœ¨')">âœ¨</span>
                        <span class="emoji-btn" @click="insertEmoji('ğŸ“¢')">ğŸ“¢</span>
                        <span class="emoji-btn" @click="insertEmoji('ğŸ§§')">ğŸ§§</span>
                        <span class="emoji-btn" @click="insertEmoji('ğŸ’¡')">ğŸ’¡</span>
                    </div>
                </div>
                
                <div class="editor-area">
                    <textarea id="my-textarea" v-model="input" @input="render" placeholder="è¯·åœ¨è¿™é‡Œç²˜è´´æ–‡å­—..."></textarea>
                </div>
            </div>

            <div class="panel-right">
                <div class="phone-frame">
                    <div class="notch"></div>
                    <div id="wx-preview" class="preview-scroll" v-html="output"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {
                const input = ref('## æ¬¢è¿ä½¿ç”¨ç»ˆæç‰ˆ\n\næˆ‘ä»¬æ ¹æ®æ‚¨çš„å»ºè®®ï¼Œå¢åŠ äº†**å­—å·è°ƒèŠ‚**å’Œ**è¡¨æƒ…åŒ…**åŠŸèƒ½ã€‚\n\nğŸ‰ è¯•ç€æ‹–åŠ¨ä¸Šæ–¹çš„æ»‘å—ï¼Œçœ‹çœ‹å­—å·çš„å˜åŒ–ï¼\n\n> è¿™æ˜¯ä¸€ä¸ªå¼•ç”¨æ¡†ï¼Œå³ä½¿åœ¨è°ƒèŠ‚å­—å·åï¼Œæ’ç‰ˆä¾ç„¶å®Œç¾ã€‚\n\n### è¿™æ˜¯ä¸€ä¸ªå°æ ‡é¢˜\n\nğŸ‘‡ ç‚¹å‡»ä¸Šæ–¹çš„â€œèŠ‚æ—¥çº¢â€ï¼Œç¬é—´å˜æˆå–œåº†é£æ ¼ï¼Œéå¸¸é€‚åˆè¿‡å¹´è¿‡èŠ‚å‘æ–‡ç« ã€‚');
                const output = ref('');
                const currentTheme = ref('business');
                const copyText = ref('å¤åˆ¶åˆ°å…¬ä¼—å·');
                
                // æ–°å¢ï¼šå…¨å±€è®¾ç½®çŠ¶æ€
                const baseFontSize = ref(16);
                const lineHeight = ref(1.7);

                // --- æ ·å¼ç”Ÿæˆå™¨ (æ ¹æ®å­—å·åŠ¨æ€ç”Ÿæˆ) ---
                const getStyles = (theme, size, height) => {
                    const commonP = `font-size: ${size}px; line-height: ${height}; margin-bottom: 20px; text-align: justify; color: #333;`;
                    
                    const themes = {
                        business: {
                            h2: `font-size: ${size * 1.15}px; color: #1f2937; margin: 30px 0 15px; padding-left: 12px; border-left: 6px solid #2563eb; background: linear-gradient(90deg, #eff6ff, transparent); padding-top:4px; padding-bottom:4px; font-weight: bold;`,
                            h3: `font-size: ${size}px; color: #2563eb; margin: 20px 0 10px; font-weight: bold;`,
                            strong: `color: #2563eb; font-weight: bold; background: #eff6ff; padding: 0 2px;`,
                            blockquote: `margin: 20px 0; padding: 15px; background: #f8fafc; border-left: 4px solid #94a3b8; color: #666; font-size: ${size * 0.95}px;`
                        },
                        warm: {
                            h2: `font-size: ${size * 1.15}px; color: #92400e; margin: 30px auto 20px; text-align: center; background: #fffbeb; padding: 8px 20px; border-radius: 50px; display: table; font-weight: bold; border: 1px solid #fde68a;`,
                            h3: `font-size: ${size}px; color: #b45309; border-bottom: 2px solid #fde68a; display: inline-block; margin-top:20px; font-weight: bold;`,
                            strong: `color: #d97706; font-weight: bold;`,
                            blockquote: `margin: 20px 10px; padding: 20px; background: #fff7ed; border-radius: 12px; color: #78350f; border: 1px dashed #fdba74; font-size: ${size * 0.95}px;`
                        },
                        clean: {
                            h2: `font-size: ${size * 1.12}px; color: #fff; margin: 30px 0 15px; background: #059669; padding: 8px 16px; border-radius: 6px; display: inline-block; box-shadow: 0 4px 6px rgba(5,150,105,0.2); font-weight: bold;`,
                            h3: `font-size: ${size}px; color: #059669; border-left: 4px solid #059669; padding-left: 8px; margin-top:20px; font-weight: bold;`,
                            strong: `color: #059669; border-bottom: 2px solid #059669;`,
                            blockquote: `margin: 20px 0; padding: 5px 15px; border-left: 3px solid #10b981; color: #666; background: #ecfdf5; font-size: ${size * 0.95}px;`
                        },
                        festive: { // æ–°å¢ï¼šèŠ‚æ—¥çº¢
                            h2: `font-size: ${size * 1.15}px; color: #b91c1c; margin: 30px 0 15px; text-align: center; background-image: url("data:image/svg+xml,%3Csvg width='20' height='20' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='10' cy='10' r='1' fill='%23e5e7eb'/%3E%3C/svg%3E"); border-top: 2px solid #b91c1c; border-bottom: 2px solid #b91c1c; padding: 10px 0; font-weight: bold;`,
                            h3: `font-size: ${size}px; color: #c02626; margin: 20px 0; display: table; background: #fee2e2; padding: 4px 10px; border-radius: 4px; font-weight: bold;`,
                            strong: `color: #b91c1c; font-weight: bold; text-decoration: underline; text-decoration-color: #fca5a5;`,
                            blockquote: `margin: 20px 0; padding: 15px; border: 2px solid #fecaca; border-radius: 8px; color: #991b1b; background: #fff5f5; font-size: ${size * 0.95}px;`
                        },
                        luxury: { // æ–°å¢ï¼šé»‘é‡‘å¥¢
                            h2: `font-size: ${size * 1.15}px; color: #d4af37; margin: 30px 0 15px; background: #1c1917; padding: 10px 20px; border-radius: 2px; text-align: center; letter-spacing: 2px; font-weight: bold;`,
                            h3: `font-size: ${size}px; color: #1c1917; margin: 20px 0 10px; border-bottom: 1px solid #d4af37; padding-bottom: 5px; display: inline-block; font-weight: bold;`,
                            strong: `color: #d4af37; background: #1c1917; padding: 0 4px; font-weight: bold;`,
                            blockquote: `margin: 20px 0; padding: 20px; border: 1px solid #d4af37; color: #444; font-family: serif; text-align: center; font-style: italic; font-size: ${size * 0.95}px;`
                        }
                    };
                    return { commonP, ...themes[theme] };
                };

                // --- æ¸²æŸ“æ ¸å¿ƒ ---
                const render = () => {
                    if (typeof marked === 'undefined') return;
                    let html = marked.parse(input.value);
                    const s = getStyles(currentTheme.value, baseFontSize.value, lineHeight.value);

                    // æ›¿æ¢æ ‡ç­¾å¹¶æ³¨å…¥æ ·å¼
                    html = html.replace(/<h2>/g, `<h2 style="${s.h2}">`);
                    html = html.replace(/<h3>/g, `<h3 style="${s.h3}">`);
                    html = html.replace(/<p>/g, `<p style="${s.commonP}">`);
                    html = html.replace(/<strong>/g, `<strong style="${s.strong}">`);
                    html = html.replace(/<blockquote>/g, `<blockquote style="${s.blockquote}">`);
                    html = html.replace(/<img/g, '<img style="max-width:100%; height:auto; border-radius:6px; display:block; margin:15px auto; box-shadow:0 2px 10px rgba(0,0,0,0.1);"');

                    output.value = html;
                };

                // è¾…åŠ©åŠŸèƒ½ï¼šæ’å…¥æ–‡å­—/è¡¨æƒ…
                const insertTextAtCursor = (textToInsert) => {
                    const textarea = document.getElementById('my-textarea');
                    const start = textarea.selectionStart;
                    const end = textarea.selectionEnd;
                    const text = input.value;
                    input.value = text.substring(0, start) + textToInsert + text.substring(end);
                    render();
                    setTimeout(() => {
                        textarea.focus();
                        textarea.setSelectionRange(start + textToInsert.length, start + textToInsert.length);
                    }, 0);
                };

                const insertFormat = (prefix, suffix) => {
                    const textarea = document.getElementById('my-textarea');
                    const start = textarea.selectionStart;
                    const end = textarea.selectionEnd;
                    const selection = input.value.substring(start, end);
                    // ç®€å•åˆ¤æ–­é¿å…é‡å¤
                    if (!selection) return; 
                    const replacement = prefix + selection + suffix;
                    input.value = input.value.substring(0, start) + replacement + input.value.substring(end);
                    render();
                };

                const insertEmoji = (emoji) => insertTextAtCursor(emoji);
                const setTheme = (key) => { currentTheme.value = key; render(); };
                const clearInput = () => { if(confirm('ç¡®å®šæ¸…ç©º?')) { input.value = ''; render(); } };

                const copyResult = async () => {
                    const el = document.getElementById('wx-preview');
                    try {
                        const blob = new Blob([el.innerHTML], { type: 'text/html' });
                        await navigator.clipboard.write([new ClipboardItem({ 'text/html': blob })]);
                        copyText.value = 'âœ… å¤åˆ¶æˆåŠŸ';
                        setTimeout(() => copyText.value = 'å¤åˆ¶åˆ°å…¬ä¼—å·', 2000);
                    } catch (e) { alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å…¨é€‰å¤åˆ¶'); }
                };

                onMounted(() => {
                    setInterval(() => { if (typeof marked !== 'undefined') render(); }, 500);
                });

                return { input, output, currentTheme, setTheme, render, copyResult, copyText, insertFormat, clearInput, insertEmoji, baseFontSize, lineHeight };
            }
        }).mount('#app');
    </script>
</body>
</html>
